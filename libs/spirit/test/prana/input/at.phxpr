;   Copyright (c) 2001-2011 Joel de Guzman
;   Copyright (c) 2001-2011 Hartmut Kaiser
;   Copyright (c) 2010-2011 Bryce Lelbach
;
;   Distributed under the Boost Software License, Version 1.0. (See accompanying
;   file BOOST_LICENSE_1_0.rst or copy at http://www.boost.org/LICENSE_1_0.txt)

(load "boost.test") 

(boost:test:suite (quote phxpr:intrinsics:at)
  ; basic
  ((variable l (quote (1 2 3)))

   (boost:test:= (at (list 1 2 3) 1) 2)
   (boost:test:= ((lambda (x) (at x (list 1 2 3))) 2) 3)
   (boost:test:= ((lambda (x) (at 1 x)) l) 2)
   (boost:test:= ((lambda (x y) (at x y)) 2 l) 3)

  ; 0 index
   (boost:test:= ((lambda (x) (at x (list 1 2 3))) 0) 1)
   (boost:test:= ((lambda (x y) (at x y)) 0 l) 1)))

