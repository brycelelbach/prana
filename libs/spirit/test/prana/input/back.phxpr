;   Copyright (c) 2001-2011 Joel de Guzman
;   Copyright (c) 2001-2011 Hartmut Kaiser
;   Copyright (c) 2010-2011 Bryce Lelbach
;
;   Distributed under the Boost Software License, Version 1.0. (See accompanying
;   file BOOST_LICENSE_1_0.rst or copy at http://www.boost.org/LICENSE_1_0.txt)

(load "boost.test") 

(boost:test:suite (quote phxpr:intrinsics:back)
  ((variable l (quote (1 2 3)))
  
  ; basic
   (boost:test:=                 (back (list 1 2 3))                         3)
   (boost:test:= ((lambda (x y)  (back (list 1 x y)))                  2 3)  3) 
   (boost:test:= ((lambda (x)    (back x))                             l)    3) 

  ; nested
   (boost:test:=                 (back (back (list 0 (list 1 2 3))))         3)
   (boost:test:= ((lambda (x y)  (back (back (list 0 (list 1 x y)))))  2 3)  3) 
   (boost:test:= ((lambda (x)    (back (back (list 0 x))))             l)    3))) 

